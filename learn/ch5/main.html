<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplikasi Pembelajaran Slide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <style>
        .fade-enter {
            opacity: 0;
        }
        .fade-enter-active {
            opacity: 1;
            transition: opacity 300ms;
        }
        .fade-exit {
            opacity: 1;
        }
        .fade-exit-active {
            opacity: 0;
            transition: opacity 300ms;
        }
    </style>
</head>
<body style="background-color: #f5f8fa; color: #040607;">
    <!-- Progress Bar -->
    <div class="w-full h-3" style="background-color: #e0e0e0;">
        <div id="progress-bar" class="h-full transition-all duration-500" style="width: 0%; background-color: #528cbd;"></div>
    </div>

    <!-- Main Content -->
    <div id="content-container" class="min-h-screen flex flex-col items-center justify-center p-8">
        <div class="max-w-3xl w-full">
            <!-- Content Text -->
            <div id="slide-content" class="text-lg leading-relaxed mb-8"></div>

            <!-- Question Section -->
            <div id="question-section" class="mb-8 hidden">
                <h3 id="question-text" class="text-xl font-semibold mb-4"></h3>
                <div id="options-container" class="space-y-3"></div>
                
                <!-- Feedback -->
                <div id="feedback" class="mt-4 p-4 rounded-lg flex items-center gap-2 hidden"></div>
            </div>

            <!-- Graph Link -->
            <div id="graph-section" class="mb-8 hidden">
                <a id="graph-link" href="#" target="_blank" rel="noopener noreferrer" 
                   class="inline-block px-6 py-3 rounded-lg text-white font-medium transition-colors"
                   style="background-color: #528cbd;">
                    Buka Grafik Desmos
                </a>
            </div>

            <!-- Next Button -->
            <div class="flex justify-end">
                <button id="next-btn" 
                        class="px-8 py-3 rounded-lg text-white font-medium transition-all cursor-not-allowed opacity-50"
                        style="background-color: #8eb7db;">
                    Next
                </button>
            </div>
        </div>
    </div>

    <script>
        let stage = 6;
        
        const slidesData = [
        {
            "id": 1,
            "content": "Bab: Turunan – Aturan Pembagian (Quotient Rule)<br>Pada bab ini kamu akan mempelajari bagaimana cara menurunkan fungsi berbentuk pembagian, seperti y = f(x) / g(x).<br>Tujuan Pembelajaran:<br>- Memahami rumus turunan pembagian.<br>- Menerapkan rumus pada soal dasar hingga menengah.<br>- Melatih pemahaman melalui interaksi dan kuis.",
            "type": "none",
            "question": "multiple-choice",
            "soal": "Menurutmu, apa yang terjadi pada turunan sebuah fungsi jika pembilang dan penyebutnya berubah terhadap x?",
            "opsi": [
                "Keduanya berkontribusi terhadap perubahan fungsi secara berbeda.",
                "Hanya pembilang yang mempengaruhi perubahan fungsi.",
                "Hanya penyebut yang mempengaruhi perubahan fungsi.",
                "Tidak ada pengaruh karena fungsi pembagian selalu konstan."
            ],
            "jawaban": "Keduanya berkontribusi terhadap perubahan fungsi secara berbeda."
        },
        {
            "id": 2,
            "content": "Aturan pembagian menyatakan bahwa jika y = u(x) / v(x), maka turunannya adalah:<br>$y' = \\frac{u'v - uv'}{v^2}$<br>Makna rumus:<br>- Turunan pembilang dikalikan fungsi penyebut.<br>- Dikurangi pembilang dikalikan turunan penyebut.<br>- Dibagi penyebut dikuadratkan.",
            "type": "none",
            "question": "multiple-choice",
            "soal": "Cocokkan konsep berikut: Manakah yang benar mengenai rumus turunan pembagian?",
            "opsi": [
                "u'(x) adalah turunan penyebut.",
                "v'(x) adalah turunan pembilang.",
                "v(x)^2 adalah penyebut dikuadratkan dalam rumus.",
                "u(x)v(x) selalu bernilai nol."
            ],
            "jawaban": "v(x)^2 adalah penyebut dikuadratkan dalam rumus."
        },
        {
            "id": 3,
            "content": "Contoh soal dasar:<br>Hitung turunan dari y = x² / (x+1)<br>Langkah-langkah:<br>- u = x² → u' = 2x<br>- v = x+1 → v' = 1<br>Maka:<br>$y' = \\frac{(2x)(x+1) - (x^2)(1)}{(x+1)^2}$",
            "type": "none",
            "question": "multiple-choice",
            "soal": "Manakah pasangan isian yang benar untuk u, u', v, v'?",
            "opsi": [
                "u=x², u'=2x, v=x+1, v'=1",
                "u=x+1, u'=1, v=x², v'=2x",
                "u=x², u'=x, v=x+1, v'=0",
                "u=x²+1, u'=2x, v=x, v'=1"
            ],
            "jawaban": "u=x², u'=2x, v=x+1, v'=1"
        },
        {
            "id": 4,
            "content": "Dari hasil sebelumnya:<br>$y' = \\frac{(2x)(x+1) - x^2}{(x+1)^2}$<br>Kembangkan pembilang:<br>2x² + 2x – x² = x² + 2x<br>Sehingga hasil akhir:<br>$y' = \\frac{x^2 + 2x}{(x+1)^2}$",
            "type": "none",
            "question": "multiple-choice",
            "soal": "Benar atau salah: 'Hasil akhir turunan dari y = x²/(x+1) adalah x(x+2)/(x+1)².'",
            "opsi": [
                "Benar",
                "Salah"
            ],
            "jawaban": "Benar"
        },
        {
            "id": 5,
            "content": "Soal latihan level menengah:<br>Turunkan fungsi y = (3x² + 4x) / (2x - 5)<br>Petunjuk:<br>- u = 3x² + 4x<br>- v = 2x - 5<br>Gunakan rumus: y' = (u'v - uv') / v²",
            "type": "none",
            "question": "multiple-choice",
            "soal": "Mana turunan yang benar untuk y = (3x² + 4x) / (2x - 5)?",
            "opsi": [
                "((6x+4)(2x-5) – (3x²+4x)(2)) / (2x-5)²",
                "((6x+4)(2x-5) + (3x²+4x)(2)) / (2x-5)²",
                "(3x²+4x)' / (2x-5)'",
                "(6x+4) / 2"
            ],
            "jawaban": "((6x+4)(2x-5) – (3x²+4x)(2)) / (2x-5)²"
        },
        {
            "id": 6,
            "content": "Aplikasi kontekstual:<br>Dalam fisika, rasio perubahan sering muncul, misalnya v = s / t.<br>Jika s(t) adalah fungsi jarak dan t adalah waktu.<br>Misal:<br>s(t) = t² + t<br>t(t) = t + 2<br>Tentukan v'(t) menggunakan aturan pembagian.",
            "type": "none",
            "question": "multiple-choice",
            "soal": "Manakah turunan yang benar untuk v(t) = (t² + t)/(t+2)?",
            "opsi": [
                "((2t+1)(t+2) – (t²+t)(1)) / (t+2)²",
                "((2t+1)(1) – (t²+t)(t+2)) / (t+2)²",
                "(2t+1)/(t+2)",
                "(t²+t)' / (t+2)'"
            ],
            "jawaban": "((2t+1)(t+2) – (t²+t)(1)) / (t+2)²"
        },
        {
            "id": 7,
            "content": "Manakah pernyataan berikut yang benar?",
            "type": "none",
            "question": "multiple-choice",
            "opsi": [
                "Rumus pembilang pada quotient rule adalah u'v – uv'.",
                "Rumus pembilang pada quotient rule adalah v'u – uv'.",
                "Quotient rule tidak membutuhkan turunan penyebut.",
                "Quotient rule sama dengan product rule."
            ],
            "jawaban": "Rumus pembilang pada quotient rule adalah u'v – uv'."
        }
    ]



        let currentSlide = 0;
        let selectedAnswer = null;
        let isCorrect = false;

        function updateProgressBar() {
            const progress = ((currentSlide + 1) / slidesData.length) * 100;
            document.getElementById('progress-bar').style.width = progress + '%';
        }

        function renderLatex() {
            if (window.renderMathInElement) {
                renderMathInElement(document.body, {
                    delimiters: [
                        {left: "$$", right: "$$", display: true},
                        {left: "$", right: "$", display: false}
                    ]
                });
            }
        }

        function renderSlide() {
            const slide = slidesData[currentSlide];
            const contentContainer = document.getElementById('content-container');
            
            // Fade out
            contentContainer.style.opacity = '0';
            
            setTimeout(() => {
                // Update content
                document.getElementById('slide-content').innerHTML = slide.content;
                
                // Handle question section
                const questionSection = document.getElementById('question-section');
                const questionText = document.getElementById('question-text');
                const optionsContainer = document.getElementById('options-container');
                const feedback = document.getElementById('feedback');
                
                if (slide.question === 'multiple-choice') {
                    questionSection.classList.remove('hidden');
                    
                    // Set question text
                    if (slide.soal) {
                        questionText.textContent = slide.soal;
                        questionText.classList.remove('hidden');
                    } else {
                        questionText.classList.add('hidden');
                    }
                    
                    // Render options
                    optionsContainer.innerHTML = '';
                    slide.opsi.forEach((option, index) => {
                        const button = document.createElement('button');
                        button.className = 'w-full p-4 text-left rounded-lg border-2 border-gray-300 hover:border-gray-400 transition-all cursor-pointer';
                        button.textContent = option;
                        button.onclick = () => handleAnswerSelect(option, button);
                        optionsContainer.appendChild(button);
                    });
                    
                    feedback.classList.add('hidden');
                } else {
                    questionSection.classList.add('hidden');
                }
                
                // Handle graph section
                const graphSection = document.getElementById('graph-section');
                const graphLink = document.getElementById('graph-link');
                
                if (slide.type === 'graph') {
                    graphSection.classList.remove('hidden');
                    graphLink.href = slide.graph;
                } else {
                    graphSection.classList.add('hidden');
                }
                
                // Update next button
                updateNextButton();
                
                // Render LaTeX
                setTimeout(renderLatex, 100);
                
                // Fade in
                contentContainer.style.opacity = '1';
            }, 300);
            
            updateProgressBar();
        }

        function handleAnswerSelect(option, buttonElement) {
            const slide = slidesData[currentSlide];
            const feedback = document.getElementById('feedback');
            const optionsContainer = document.getElementById('options-container');
            
            // Reset all buttons
            const buttons = optionsContainer.querySelectorAll('button');
            buttons.forEach(btn => {
                btn.className = 'w-full p-4 text-left rounded-lg border-2 border-gray-300 hover:border-gray-400 transition-all cursor-pointer';
            });
            
            selectedAnswer = option;
            
            if (option === slide.jawaban) {
                isCorrect = true;
                buttonElement.className = 'w-full p-4 text-left rounded-lg border-2 border-green-500 bg-green-50 transition-all';
                feedback.className = 'mt-4 p-4 rounded-lg flex items-center gap-2 bg-green-100 text-green-800';
                feedback.innerHTML = `
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span class="font-semibold">Benar! Jawaban Anda tepat.</span>
                `;
                feedback.classList.remove('hidden');
            } else {
                isCorrect = false;
                buttonElement.className = 'w-full p-4 text-left rounded-lg border-2 border-red-500 bg-red-50 transition-all';
                feedback.className = 'mt-4 p-4 rounded-lg flex items-center gap-2 bg-red-100 text-red-800';
                feedback.innerHTML = `
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span class="font-semibold">Salah, coba lagi.</span>
                `;
                feedback.classList.remove('hidden');
            }
            
            updateNextButton();
        }

        function updateNextButton() {
            const slide = slidesData[currentSlide];
            const nextBtn = document.getElementById('next-btn');
            const canProceed = slide.question === 'none' || isCorrect;
            
            if (canProceed) {
                nextBtn.disabled = false;
                nextBtn.className = 'px-8 py-3 rounded-lg text-white font-medium transition-all cursor-pointer';
                nextBtn.style.backgroundColor = '#528cbd';
                nextBtn.onmouseover = () => nextBtn.style.backgroundColor = '#3dbaf9';
                nextBtn.onmouseout = () => nextBtn.style.backgroundColor = '#528cbd';
            } else {
                nextBtn.disabled = true;
                nextBtn.className = 'px-8 py-3 rounded-lg text-white font-medium transition-all cursor-not-allowed opacity-50';
                nextBtn.style.backgroundColor = '#8eb7db';
                nextBtn.onmouseover = null;
                nextBtn.onmouseout = null;
            }
            
            if (currentSlide === slidesData.length - 1) {
                nextBtn.textContent = 'Selesai';
            } else {
                nextBtn.textContent = 'Next';
            }
        }

        function handleNext() {
            const slide = slidesData[currentSlide];
            const canProceed = slide.question === 'none' || isCorrect;
            
            if (!canProceed) return;
            
            if (currentSlide === slidesData.length - 1) {
                let userID = localStorage.getItem('userCurrentLevelId');
                if(userID == stage) {
                    localStorage.setItem('userCurrentLevelId', stage + 1);
                }

                window.location.href = "../../main.html";
            } else {
                currentSlide++;
                selectedAnswer = null;
                isCorrect = false;
                renderSlide();
            }
        }

        // Initialize
        document.getElementById('next-btn').onclick = handleNext;
        document.getElementById('content-container').style.transition = 'opacity 300ms';
        
        // Wait for KaTeX to load
        window.addEventListener('load', () => {
            setTimeout(() => {
                renderSlide();
            }, 100);
        });
    </script>
</body>
</html>